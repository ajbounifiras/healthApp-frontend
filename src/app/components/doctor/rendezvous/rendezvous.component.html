<div class="rendezvous-page">
  <div class="container">
    <div class="page-header">
      <h1>Mes Rendez-vous</h1>
      <a [routerLink]="isSecretary ? '/secretary' : '/doctor'" class="btn btn-secondary">
        ‚Üê Retour au tableau de bord
      </a>
    </div>

    <div *ngIf="loading" class="loading">Chargement des rendez-vous...</div>
    <div class="filters-section" *ngIf="!loading && rendezVousList.length > 0">
      <!-- Filtre par statut - UNIQUEMENT pour les secr√©taires -->
      <div class="filter-group" *ngIf="isSecretary">
        <label for="filterStatus">Statut:</label>
        <select id="filterStatus" [(ngModel)]="filterStatus" (change)="onFilterChange()" class="form-control">
          <option value="all">Tous</option>
          <option value="accepted">Accept√©s</option>
          <option value="pending">En attente</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="filterDate">P√©riode:</label>
        <select id="filterDate" [(ngModel)]="filterDate" (change)="onFilterChange()" class="form-control">
          <option value="all">Tous</option>
          <option value="today">Aujourd'hui</option>
          <option value="week">Cette semaine</option>
          <option value="month">Ce mois</option>
        </select>
      </div>

      <div class="filter-results">
        <strong>{{ filteredRendezVous.length }}</strong> rendez-vous trouv√©(s)
      </div>
    </div>

    <div class="card" *ngIf="!loading">
      <div *ngIf="rendezVousList.length === 0" class="empty-state">
        <div class="empty-state-icon">üìÖ</div>
        <h3>Aucun rendez-vous</h3>
        <p>Vous n'avez pas encore de rendez-vous</p>
      </div>

      <table *ngIf="filteredRendezVous.length > 0">
        <thead>
          <tr>
            <th>Patient</th>
            <th>Date & Heure</th>
            <th>Sp√©cialit√©</th>
            <th>Notes</th>
            <th>Statut</th>
            <th *ngIf="isSecretary">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let rdv of filteredRendezVous">
            <td>
              <strong>{{ rdv.patient?.firstName }} {{ rdv.patient?.lastName }}</strong>
              <br>
              <small>{{ rdv.patient?.email }}</small>
            </td>
            <td>
              <strong>{{ rdv.dateRendezVous | date: 'dd/MM/yyyy' }}</strong>
              <br>
              <small>{{ rdv.dateRendezVous | date: 'HH:mm' }}</small>
            </td>
            <td>
              <span class="specialty-badge">{{ rdv.speciality }}</span>
            </td>
            <td>{{ rdv.notes || 'Aucune note' }}</td>
            <td>
              <span [class]="'badge ' + getStatusBadgeClass(rdv)">
                {{ getStatusText(rdv) }}
              </span>
            </td>
            <td *ngIf="isSecretary">
              <div class="action-buttons">
                <button *ngIf="!rdv.accepted" class="btn btn-success btn-sm" (click)="accepterRendezVous(rdv.id!)">
                  ‚úì Accepter
                </button>
                <button class="btn btn-danger btn-sm" (click)="annulerRendezVous(rdv.id!)">
                  ‚úó Annuler
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="rendezVousList.length > 0 && filteredRendezVous.length === 0" class="empty-state">
        <div class="empty-state-icon">üîç</div>
        <h3>Aucun r√©sultat</h3>
        <p>Aucun rendez-vous ne correspond aux filtres s√©lectionn√©s</p>
      </div>
    </div>
  </div>
</div>